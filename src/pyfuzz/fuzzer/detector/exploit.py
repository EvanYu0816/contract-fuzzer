from pyfuzz.fuzzer.interface import Transaction

class Exploit():
    def __init__(self, type, txList):
        assert(isinstance(txList, list))
        self.type = type
        self.txList = txList

    def __repr__(self):
        res = "exploitation: {}\n".format(self.type)
        for i in range(len(self.txList)):
            if not isinstance(self.txList[i], Transaction):
                continue
            res += "[{}] {}\n".format(str(i), repr(self.txList[i]))
        return res

    def __dict__(self):
        return {
            "type": self.type,
            "tx_list": self.txList
        }

    def __hash__(self):
        import hashlib
        m = hashlib.md5()
        payload = str(self.__dict__())
        m.update(payload.encode("utf-8"))
        return int(m.hexdigest(), 16)

    def __eq__(self, other):
        return self.__class__ == self.__class__ and self.__repr__() == self.__repr__()